<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>√Årea de Conte√∫do - O C√≥digo do Sono</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chosen Palette: Warm Neutral Harmony -->
    <!-- Application Structure Plan: A dashboard-style SPA serving as a content and tools area. Navigation is handled by a persistent sidebar, allowing users to switch between sections like a native application. The core sections include: 1) A 'Painel' (Dashboard) for user orientation. 2) The 'Diagn√≥stico' quiz for personalization. 3) An interactive 'Plano Circadiano' to visually explore the body's clock. 4) A 'Biblioteca' with all e-book content organized by topic. 5) A 'Ferramentas' section with the breathing guide and ritual builder. 6) A 'Desafios' section for the 7-day program. This structure is chosen to transform static content into an engaging, explorable, and tool-based experience, increasing user retention and perceived value over a simple e-book. -->
    <!-- Visualization & Content Choices: The app leverages interactivity for education and utility. 1) Interactive Circadian Plan: An HTML/CSS/JS-powered visual diagram where users click time segments to reveal detailed physiological information, making a complex concept tangible and explorable. 2) Quiz & Personalized Plan: Re-purposed from the sales page to serve as an onboarding tool within the app. 3) Content Library: E-book text is chunked into thematic cards with modals, improving readability and navigation over a linear PDF. 4) Interactive Tools: The existing breathing guide and ritual builder are integrated as core features, transforming the product from just information into a utility. The 7-day challenge uses interactive checkboxes to track progress. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f9fafb; /* Lighter gray for app feel */
            color: #374151;
        }
        .sidebar-link {
            transition: all 0.2s ease-in-out;
        }
        .sidebar-link.active {
            background-color: #EAE3DC;
            color: #4A5568;
            font-weight: 600;
        }
        .circadian-segment {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }
        .circadian-segment:hover {
            transform: scale(1.05);
            filter: brightness(1.1);
        }
        .circadian-segment.active {
             border: 4px solid #4A5568;
             transform: scale(1.05);
        }
        .breathing-dot {
            transition: transform var(--transition-duration, 3.8s) cubic-bezier(0.4, 0, 0.2, 1);
        }
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.5);
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body class="antialiased">
    <div class="flex h-screen bg-gray-100">
        <!-- Sidebar -->
        <aside class="w-64 flex-shrink-0 bg-white border-r hidden md:flex flex-col">
            <div class="h-16 flex items-center justify-center border-b px-4">
                <h1 class="text-2xl font-bold text-[#4A5568]"><span class="text-[#8C7A6B]">‚òæ</span> O C√≥digo do Sono</h1>
            </div>
            <nav id="sidebar-nav" class="flex-grow p-4 space-y-2">
                <a href="#painel" data-section="painel" class="sidebar-link flex items-center px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-200">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path></svg>
                    Meu Painel
                </a>
                <a href="#local-respiracao" data-section="local-respiracao" class="sidebar-link flex items-center px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-200">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.5 6.5A2.5 2.5 0 016 4h12a2.5 2.5 0 010 5H6a2.5 2.5 0 01-2.5-2.5zM3.5 17.5a2.5 2.5 0 012.5-2.5h12a2.5 2.5 0 010 5H6a2.5 2.5 0 01-2.5-2.5z"></path></svg>
                    Local de Respira√ß√£o
                </a>
                <a href="#plano-circadiano" data-section="plano-circadiano" class="sidebar-link flex items-center px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-200">
                     <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    Plano Circadiano
                </a>
                 <a href="#biblioteca" data-section="biblioteca" class="sidebar-link flex items-center px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-200">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M4 6h16M4 12h16M4 18h16" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path></svg>
                    Biblioteca
                </a>
                 <a href="#chas-para-dormir" data-section="chas-para-dormir" class="sidebar-link flex items-center px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-200">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 18h2a2 2 0 002-2v-2a2 2 0 00-2-2h-2a2 2 0 00-2 2v2a2 2 0 002 2zM4 8h16M4 8a4 4 0 014-4h8a4 4 0 014 4v0"></path></svg>
                    Ch√°s para Dormir
                </a>
                 <a href="#desafios" data-section="desafios" class="sidebar-link flex items-center px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-200">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    Desafios
                </a>
                <a href="#depoimentos" data-section="depoimentos" class="sidebar-link flex items-center px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-200">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a2 2 0 01-2-2V10a2 2 0 012-2h8z"></path></svg>
                    Depoimentos
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <header class="h-16 flex items-center justify-between px-6 bg-white border-b">
                 <div id="welcome-message" class="text-gray-600 md:flex-1">Bem-vindo(a)!</div>
                 <button id="mobile-menu-btn" class="md:hidden text-2xl">‚ò∞</button>
            </header>

            <main class="flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 p-6 md:p-8">
                <div id="app-content">
                    <!-- Dynamic content will be loaded here -->
                </div>
            </main>
        </div>
    </div>
    
    <!-- Mobile Sidebar -->
    <div id="mobile-sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-10 hidden"></div>
    <div id="mobile-sidebar" class="fixed top-0 left-0 h-full w-64 bg-white z-20 transform -translate-x-full transition-transform duration-300 ease-in-out">
        <div class="h-16 flex items-center justify-between border-b px-4">
            <h1 class="text-xl font-bold text-[#4A5568]"><span class="text-[#8C7A6B]">‚òæ</span> O C√≥digo do Sono</h1>
            <button id="close-mobile-menu" class="text-2xl">&times;</button>
        </div>
        <nav id="mobile-sidebar-nav" class="p-4 space-y-2">
           <!-- Mobile nav links will be copied here -->
        </nav>
    </div>
    
    <!-- Generic Modal -->
    <div id="generic-modal-container" class="fixed inset-0 z-50 items-center justify-center hidden">
        <div class="modal-backdrop fixed inset-0 bg-black bg-opacity-60"></div>
        <div class="relative bg-white w-11/12 md:max-w-xl mx-auto rounded-lg shadow-lg p-8 max-h-[80vh] overflow-y-auto">
             <button id="generic-modal-close" class="absolute top-4 right-4 text-2xl text-gray-500 hover:text-gray-800">&times;</button>
             <div id="generic-modal-content"></div>
        </div>
    </div>
    
    <!-- Welcome Popup -->
    <div id="welcome-modal-container" class="fixed inset-0 z-50 items-center justify-center hidden">
        <div class="fixed inset-0 bg-black bg-opacity-60"></div>
        <div class="relative bg-white w-11/12 md:max-w-md mx-auto rounded-lg shadow-lg p-8 text-center">
            <h2 class="text-2xl font-bold text-[#4A5568] mb-4">Bem-vindo(a) ao C√≥digo do Sono!</h2>
            <p class="text-gray-600 mb-6">Parab√©ns por investir em voc√™ e na sua sa√∫de. Para personalizar sua experi√™ncia, como podemos te chamar?</p>
            <form id="welcome-form">
                <input type="text" id="name-input" placeholder="Digite seu nome aqui" class="w-full px-4 py-2 border border-gray-300 rounded-md mb-4 focus:ring-[#8C7A6B] focus:border-[#8C7A6B]" required>
                <button type="submit" class="w-full bg-[#8C7A6B] text-white px-6 py-3 rounded-full font-semibold hover:bg-[#7a6a5a] transition-colors">Continuar</button>
            </form>
        </div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // APP DATA AND CONTENT
    const appData = {
        testimonials: [
            { name: 'Juliana P.', rating: 5, comment: 'Eu n√£o acreditava que pequenas mudan√ßas fariam tanta diferen√ßa. O desafio dos 7 dias mudou tudo para mim. Voltei a ter energia!' },
            { name: 'Marcos R.', rating: 5, comment: 'O guia de respira√ß√£o √© incr√≠vel. Uso sempre que me sinto ansioso antes de deitar e funciona de verdade. Durmo muito mais r√°pido.' },
            { name: 'Carla F.', rating: 4, comment: 'Entender o plano circadiano foi um divisor de √°guas. Ajustei meus hor√°rios e a qualidade do meu sono melhorou 100%.' },
            { name: 'Ricardo G.', rating: 5, comment: 'Finalmente um guia pr√°tico e sem enrola√ß√£o. Os ch√°s s√£o √≥timos e o conte√∫do √© direto ao ponto. Recomendo demais!' },
            { name: 'Fernanda L.', rating: 5, comment: 'O construtor de rituais foi o que eu precisava! Ter um plano claro para a noite me ajudou a criar um h√°bito que eu finalmente consigo seguir.' },
            { name: 'Lucas M.', rating: 5, comment: 'N√£o √© s√≥ sobre dormir, √© sobre viver melhor. Com noites de sono de qualidade, meu humor e minha produtividade no trabalho melhoraram absurdamente.' }
        ],
        teaRecipes: [
            { id: 'camomila', emoji: 'üåº', title: 'Ch√° de Camomila', benefit: 'Para acalmar e relaxar a mente.', recipe: 'Adicione um punhado de flores frescas em 250ml de √°gua fervente. Deixe repousar por 5 a 10 minutos, coe e beba.', warning: 'Evitar em gr√°vidas e crian√ßas sem orienta√ß√£o m√©dica.' },
            { id: 'passiflora', emoji: 'üå∏', title: 'Ch√° de Passiflora', benefit: 'Excelente para estresse e ansiedade.', recipe: 'Use 1 colher de sopa de folhas secas em 250ml de √°gua fervente. Deixe repousar por 10 minutos. Coe antes de beber.', warning: 'N√£o ingerir na gravidez ou por crian√ßas menores de 12 anos. Pode interferir com medicamentos como aspirina.' },
            { id: 'valeriana', emoji: 'üåø', title: 'Ch√° de Valeriana', benefit: 'Aumenta o tempo de sono e reduz despertares.', recipe: 'Coloque 1 colher de sopa da ra√≠z de valeriana em 250ml de √°gua fervente. Deixe repousar por 10 a 15 minutos.', warning: 'Usar com cuidado em gr√°vidas e pessoas com problemas no f√≠gado.' },
            { id: 'erva-cidreira', emoji: 'üçÉ', title: 'Ch√° de Erva-Cidreira', benefit: 'Relaxa o sistema nervoso.', recipe: 'Adicione 1 colher de folhas secas em 250ml de √°gua fervente. Deixe repousar por 5 a 10 minutos antes de coar.', warning: 'Evitar durante a gravidez e lacta√ß√£o.' },
            { id: 'erva-sao-joao', emoji: '‚òÄÔ∏è', title: 'Erva-de-S√£o-Jo√£o', benefit: 'Combate estados depressivos e ansiedade.', recipe: 'Use 1 colher de ch√° da erva seca em 250ml de √°gua fervente. Deixe repousar por 5 minutos.', warning: 'N√£o usar na gravidez, amamenta√ß√£o ou com anticoncepcionais orais. Evitar com antidepressivos.' },
            { id: 'lavanda', emoji: 'üíú', title: 'Ch√° de Lavanda', benefit: 'Reduz agita√ß√£o e melhora o bem-estar geral.', recipe: 'Adicione 30g de flores picadas em 1 litro de √°gua fervente e apague o fogo. Tampe e deixe esfriar.', warning: 'N√£o deve ser consumido por gestantes, crian√ßas ou pessoas com √∫lcera g√°strica.' },
            { id: 'tilia', emoji: 'üå≥', title: 'Ch√° de T√≠lia', benefit: 'Alivia crises de ansiedade, calmante natural.', recipe: 'Adicione 1.5g de folhas secas em 150ml de √°gua fervente. Deixe repousar por 5 a 10 minutos.', warning: 'N√£o usar em crian√ßas menores de 4 anos, gr√°vidas, lactantes ou pessoas com problemas card√≠acos.' },
            { id: 'mulungu', emoji: 'üî¥', title: 'Ch√° de Mulungu', benefit: 'A√ß√£o calmante e tranquilizante.', recipe: 'Ferva 4g da casca em uma x√≠cara de √°gua por 15 minutos. Coe e beba. N√£o tomar por mais de 3 dias seguidos.', warning: 'N√£o usar em crian√ßas menores de 5 anos, gr√°vidas, lactantes ou junto com anti-hipertensivos.' },
            { id: 'curcuma', emoji: 'üß°', title: 'Ch√° de C√∫rcuma', benefit: 'A√ß√£o ansiol√≠tica que melhora o sono.', recipe: 'Misture 1 colher de ch√° de c√∫rcuma em p√≥ em 150ml de √°gua fervente. Deixe repousar por 10 minutos.', warning: 'N√£o usar com anticoagulantes ou se tiver pedra na ves√≠cula. Evitar na gravidez.' },
            { id: 'hortela', emoji: 'üå±', title: 'Ch√° de Hortel√£-pimenta', benefit: 'Alivia o estresse mental e a ansiedade.', recipe: 'Adicione 1 colher de sopa de folhas em 150ml de √°gua fervente. Deixe repousar por 5 a 10 minutos.', warning: 'Consumir com modera√ß√£o.' }
        ],
        circadianPlan: [
            { time: "06:00", title: "Despertar e Exposi√ß√£o √† Luz", icon: "‚òÄÔ∏è", description: "A luz solar ao acordar inibe a melatonina e ajusta seu rel√≥gio interno. Tente pegar 15 minutos de sol na primeira hora do dia." },
            { time: "10:00", title: "Pico de Alerta Mental", icon: "üí°", description: "Sua concentra√ß√£o e foco est√£o no auge. √â o melhor momento para tarefas que exigem alta performance mental." },
            { time: "14:30", title: "Melhor Coordena√ß√£o", icon: "ü§∏", description: "Seu corpo est√° no pico de coordena√ß√£o motora. Bom momento para atividades que exigem precis√£o." },
            { time: "17:00", title: "Pico de For√ßa Muscular", icon: "üí™", description: "A for√ßa cardiovascular e muscular atinge seu m√°ximo. Ideal para exerc√≠cios f√≠sicos mais intensos." },
            { time: "19:00", title: "Pico de Press√£o Sangu√≠nea", icon: "ü©∏", description: "Sua press√£o e temperatura corporal atingem o pico. O corpo come√ßa a se preparar para desacelerar." },
            { time: "21:00", title: "In√≠cio da Secre√ß√£o de Melatonina", icon: "üß†", description: "Com a diminui√ß√£o da luz, seu c√©rebro come√ßa a produzir melatonina, o horm√¥nio do sono. √â crucial reduzir as luzes azuis agora." },
            { time: "22:30", title: "Supress√£o de Movimentos Intestinais", icon: "ü§´", description: "Seu sistema digestivo desacelera. Evite refei√ß√µes pesadas a partir deste hor√°rio para n√£o atrapalhar o sono." },
            { time: "02:00", title: "Sono Mais Profundo", icon: "üò¥", description: "Seu corpo est√° em seu estado de maior relaxamento. √â a fase de repara√ß√£o celular e consolida√ß√£o da mem√≥ria." },
        ],
        library: [
            { id: 1, category: "Ambiente", title: "O Santu√°rio do Sono", content: `<h3>Preparando o Seu Ambiente</h3><p>Seu quarto precisa ser um ref√∫gio, associado exclusivamente ao descanso. Tr√™s pilares s√£o essenciais:</p><ul><li class="mt-2"><strong>Escurid√£o Total:</strong> A luz inibe a melatonina. Use cortinas blackout e cubra luzes de eletr√¥nicos.</li><li class="mt-2"><strong>Sil√™ncio:</strong> Ru√≠dos fragmentam o sono. Considere tamp√µes de ouvido ou ru√≠do branco.</li><li class="mt-2"><strong>Temperatura Fresca:</strong> Um ambiente entre 18¬∞C e 21¬∞C ajuda o corpo a iniciar o sono.</li></ul><p class="mt-4 font-semibold">Lembrete: A cama √© para dormir e ter rela√ß√µes √≠ntimas. Evite trabalhar ou comer nela para fortalecer a associa√ß√£o mental com o descanso.</p>` },
            { id: 2, category: "Rotina", title: "O Rel√≥gio Interno", content: `<h3>A Magia da Rotina</h3><p>Nosso corpo tem um rel√≥gio biol√≥gico (ciclo circadiano) que ama consist√™ncia. Ajust√°-lo √© fundamental.</p><ul><li class="mt-2"><strong>Hor√°rios Fixos:</strong> O pilar mais importante. Tente dormir e, principalmente, acordar no mesmo hor√°rio todos os dias, incluindo fins de semana.</li><li class="mt-2"><strong>Luz Solar Matinal:</strong> Exponha-se √† luz natural na primeira hora do dia para "zerar" seu rel√≥gio.</li><li class="mt-2"><strong>Luzes Noturnas:</strong> Reduza a intensidade das luzes em casa √† noite. Troque luzes brancas por amarelas para sinalizar ao c√©rebro que o dia est√° acabando.</li></ul>` },
            { id: 4, category: "Est√≠mulos", title: "O Ritual de Desacelera√ß√£o", content: `<h3>O Preparo para a Noite</h3><p>O c√©rebro precisa de um tempo de transi√ß√£o para desligar. Crie um ritual relaxante de 60 minutos.</p><ul><li class="mt-2"><strong>Desconecte-se das Telas:</strong> A luz azul inibe a melatonina. Desligue celular, TV e computador uma hora antes de dormir.</li><li class="mt-2"><strong>Atividades Calmas:</strong> Opte por um banho quente, leitura de um livro f√≠sico, medita√ß√£o ou m√∫sica tranquila.</li><li class="mt-2"><strong>Esvazie a Mente:</strong> Anote preocupa√ß√µes ou tarefas do dia seguinte em um caderno para liberar a mente.</li></ul>` },
            { id: 5, category: "Emerg√™ncia", title: "Guia de Emerg√™ncia", content: `<h3>Acordou no Meio da Noite?</h3><p>√â normal, mas a rea√ß√£o errada pode sabotar seu sono. A regra √©: n√£o se esforce.</p><p class="font-semibold mt-4">O que N√ÉO fazer:</p><ul><li>N√ÉO olhe o rel√≥gio.</li><li>N√ÉO pegue o celular.</li><li>N√ÉO acenda luzes fortes.</li><li>N√ÉO fique se revirando na cama por mais de 20 minutos.</li></ul><p class="font-semibold mt-4">O que FAZER:</p><ul><li>Levante-se, v√° para outro c√¥modo com pouca luz e fa√ßa algo mon√≥tono.</li><li>Relaxe, mesmo acordado. O descanso parcial j√° √© ben√©fico.</li><li>Pratique a respira√ß√£o 4x4.</li></ul>`},
        ],
        quiz: [
            { question: "Seus hor√°rios de dormir e acordar s√£o uma bagun√ßa ou voc√™ √© mais regrado?", options: ["üòá Sou um reloginho, durmo e acordo quase sempre na mesma hora.", "ü§î Durante a semana at√© tento, mas no fim de semana a rotina some.", "üòµ √â uma bagun√ßa. Cada noite durmo em um hor√°rio diferente."], category: "Rotina" },
            { question: "Com que frequ√™ncia voc√™ usa o celular ou assiste TV na cama antes de dormir?", options: ["üòá Nunca ou raramente.", "ü§î Algumas vezes por semana.", "üòµ Quase todas as noites."], category: "Est√≠mulos" },
            { question: "Como √© o seu quarto na hora de dormir?", options: ["üòá Totalmente escuro, silencioso e fresco.", "ü§î Tem um pouco de luz ou ru√≠do.", "üòµ Muitas luzes de aparelhos ou barulho externo."], category: "Ambiente" },
        ],
        breathingTools: [
            { id: 'box', title: 'Respira√ß√£o Quadrada (4-4-4-4)', purpose: 'Para foco e calma instant√¢nea.', when: 'Use durante picos de estresse no trabalho ou para se centrar antes de uma tarefa importante.', steps: [ { label: 'Inspire...', duration: 4, scale: 5 }, { label: 'Segure', duration: 4, scale: 5 }, { label: 'Expire...', duration: 4, scale: 1 }, { label: 'Segure', duration: 4, scale: 1 } ] },
            { id: 'relax', title: 'Respira√ß√£o Relaxante (4-7-8)', purpose: 'Para induzir o sono profundamente.', when: 'Fa√ßa deitado na cama, logo antes de dormir. √â conhecida como o "tranquilizante natural".', steps: [ { label: 'Inspire...', duration: 4, scale: 5 }, { label: 'Segure', duration: 7, scale: 5 }, { label: 'Expire...', duration: 8, scale: 1 } ] },
            { id: 'calm', title: 'Respira√ß√£o Calmante (4-2-6)', purpose: 'Para aliviar a ansiedade.', when: 'Quando se sentir ansioso ou sobrecarregado. A expira√ß√£o longa ativa o sistema parassimp√°tico (relaxamento).', steps: [ { label: 'Inspire...', duration: 4, scale: 5 }, { label: 'Segure', duration: 2, scale: 5 }, { label: 'Expire...', duration: 6, scale: 1 } ] },
            { id: 'diaphragmatic', title: 'Respira√ß√£o Base (Diafragm√°tica)', purpose: 'Para aprender a respirar corretamente.', when: 'Pratique a qualquer momento do dia para criar o h√°bito. √â a base de todas as outras t√©cnicas.', steps: [ { label: 'Inspire pela barriga...', duration: 4, scale: 5 }, { label: 'Expire lentamente...', duration: 6, scale: 1 } ] }
        ],
        challenges: [
            { title: "Detox Digital Noturno", description: "Nenhum aparelho eletr√¥nico (celular, TV, tablet) 60 minutos antes de dormir." },
            { title: "Calibra√ß√£o do Rel√≥gio Biol√≥gico", description: "Exponha-se a 15 minutos de luz solar na primeira hora ap√≥s acordar." },
            { title: "Otimiza√ß√£o do Santu√°rio", description: "Garanta que seu quarto esteja 100% escuro, usando tamp√µes ou blackout se necess√°rio." },
            { title: "Di√°rio da Mente", description: "Anote 3 preocupa√ß√µes em um caderno antes de iniciar seu ritual de desacelera√ß√£o." },
            { title: "Respira√ß√£o Consciente", description: "Pratique o exerc√≠cio de respira√ß√£o 4x4 por 3 minutos antes de deitar." },
            { title: "Zero Cafe√≠na Ap√≥s as 15h", description: "Nenhuma bebida com cafe√≠na (caf√©, ch√°s escuros, refrigerantes, energ√©ticos) ap√≥s as 15:00." },
            { title: "Consist√™ncia no Despertar", description: "Acorde no mesmo hor√°rio dos outros dias, mesmo sendo fim de semana." },
        ]
    };

    const appContent = document.getElementById('app-content');
    let currentAnimation = { timeoutId: null, toolId: null };

    const sections = {
        painel: `
            <h2 class="text-3xl font-bold text-gray-800 mb-2">Bem-vindo(a) √† sua Jornada do Sono!</h2>
            <p class="text-gray-600 mb-8">Este √© o seu painel de controle para decifrar o c√≥digo do sono. Explore as se√ß√µes para aprender e aplicar as t√©cnicas que transformar√£o suas noites.</p>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="bg-white p-6 rounded-lg shadow-md hover:shadow-xl transition-shadow cursor-pointer" data-nav-link="plano-circadiano">
                    <h3 class="font-bold text-xl mb-2 text-[#4A5568]">1. Entenda seu Corpo</h3>
                    <p class="text-gray-600">Fa√ßa o diagn√≥stico e explore o Plano Circadiano interativo.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md hover:shadow-xl transition-shadow cursor-pointer" data-nav-link="local-respiracao">
                    <h3 class="font-bold text-xl mb-2 text-[#4A5568]">2. Acalme sua Mente</h3>
                    <p class="text-gray-600">Use as ferramentas de respira√ß√£o para relaxar instantaneamente.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md hover:shadow-xl transition-shadow cursor-pointer" data-nav-link="biblioteca">
                    <h3 class="font-bold text-xl mb-2 text-[#4A5568]">3. Aprofunde o Conhecimento</h3>
                    <p class="text-gray-600">Navegue pela Biblioteca e aprenda sobre os 5 pilares do sono.</p>
                </div>
            </div>
        `,
        'plano-circadiano': `
            <h2 class="text-3xl font-bold text-gray-800 mb-2">Plano Circadiano e Diagn√≥stico</h2>
            <p class="text-gray-600 mb-8">Responda o quiz para se autoconhecer e depois explore como seu corpo funciona durante o dia.</p>
            <div class="bg-white rounded-lg p-8 md:p-12 shadow-lg mb-8">
                <h3 class="text-2xl font-bold text-center text-[#4A5568] mb-2">Passo 1: Diagn√≥stico R√°pido</h3>
                <p class="text-center text-gray-600 mb-8">Entenda seus h√°bitos atuais.</p>
                <div id="quiz-container-app"></div>
                 <div class="text-center mt-8">
                    <button id="submit-quiz-app" class="bg-[#8C7A6B] text-white px-8 py-3 rounded-full text-lg font-semibold hover:bg-[#7a6a5a] transition-colors disabled:bg-gray-400" disabled>Ver Minhas Recomenda√ß√µes</button>
                </div>
                 <div id="plan-app" class="hidden mt-8"></div>
            </div>
            <div class="bg-white rounded-lg p-6 shadow-lg flex flex-col lg:flex-row gap-6">
                <div class="w-full lg:w-1/2 flex items-center justify-center">
                    <div id="circadian-clock" class="relative w-80 h-80 rounded-full">
                        ${appData.circadianPlan.map((item, index) => {
                            const angle = (index / appData.circadianPlan.length) * 360 - 90;
                            const x = 50 + 45 * Math.cos(angle * Math.PI / 180);
                            const y = 50 + 45 * Math.sin(angle * Math.PI / 180);
                            const color = index >= 5 ? 'bg-blue-200' : 'bg-orange-200';
                            return `<div class="circadian-segment absolute w-16 h-16 rounded-full flex items-center justify-center text-2xl ${color} shadow-md" style="left: ${x-8}%; top: ${y-8}%;" data-index="${index}">${item.icon}</div>`;
                        }).join('')}
                         <div class="absolute w-60 h-60 bg-gray-100 rounded-full top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 border-8 border-white shadow-inner"></div>
                    </div>
                </div>
                <div id="circadian-details" class="w-full lg:w-1/2 bg-gray-50 p-6 rounded-lg">
                    <h3 class="font-bold text-xl mb-2 text-[#4A5568]">Passo 2: Explore seu Rel√≥gio Biol√≥gico</h3>
                    <p class="text-gray-600">Clique em um dos √≠cones no rel√≥gio para ver os detalhes aqui.</p>
                </div>
            </div>
        `,
        biblioteca: `
            <h2 class="text-3xl font-bold text-gray-800 mb-2">Biblioteca de Conte√∫do</h2>
            <p class="text-gray-600 mb-8">Todo o conhecimento do guia "O C√≥digo do Sono", organizado para voc√™.</p>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                ${appData.library.map(item => `
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="font-bold text-xl mb-2 text-[#4A5568]">${item.title}</h3>
                        <div class="prose prose-sm max-w-none text-gray-600">${item.content.replace(/<h3>.*?<\/h3>/, '').replace(/<p>/, '<p class="line-clamp-3">')}</div>
                    </div>
                `).join('')}
            </div>
        `,
        'chas-para-dormir': `
            <h2 class="text-3xl font-bold text-gray-800 mb-2">Ch√°s para Dormir</h2>
            <p class="text-gray-600 mb-8">Receitas naturais para ajudar a relaxar antes de deitar.</p>
            <div id="tea-recipes-container" class="grid md:grid-cols-2 gap-6"></div>
        `,
        'local-respiracao': `
            <h2 class="text-3xl font-bold text-gray-800 mb-2">Local de Respira√ß√£o</h2>
            <p class="text-gray-600 mb-8">T√©cnicas guiadas para acalmar a mente e relaxar o corpo a qualquer momento.</p>
            <div class="bg-white rounded-lg p-6 shadow-lg mb-8">
                <h3 class="font-bold text-xl mb-3 text-[#4A5568]">Como Praticar</h3>
                <div class="grid md:grid-cols-2 gap-4 text-sm text-gray-600">
                    <p><strong>Postura:</strong> Sente-se ou deite-se confortavelmente com a coluna ereta.</p>
                    <p><strong>Ambiente:</strong> Escolha um local silencioso onde n√£o ser√° interrompido.</p>
                    <p><strong>Tempo:</strong> Pratique por 2 a 5 minutos para sentir os efeitos.</p>
                    <p><strong>Dica:</strong> Feche os olhos e concentre-se apenas no ar entrando e saindo.</p>
                </div>
            </div>
            <div id="breathing-tools-container" class="grid md:grid-cols-2 gap-8"></div>
        `,
        desafios: `
            <h2 class="text-3xl font-bold text-gray-800 mb-2">Desafio dos 7 Dias</h2>
            <p class="text-gray-600 mb-8">Complete uma miss√£o por dia para transformar seu sono. Marque as tarefas conclu√≠das.</p>
            <div class="bg-white rounded-lg p-8 shadow-lg space-y-4">
                ${appData.challenges.map((challenge, index) => `
                    <label class="flex items-center p-4 border rounded-lg hover:bg-gray-50 cursor-pointer">
                        <input type="checkbox" class="h-5 w-5 rounded border-gray-300 text-[#8C7A6B] focus:ring-[#8C7A6B]">
                        <span class="ml-4">
                            <span class="font-semibold text-gray-800">Dia ${index + 1}: ${challenge.title}</span>
                            <span class="block text-sm text-gray-500">${challenge.description}</span>
                        </span>
                    </label>
                `).join('')}
            </div>
        `,
        depoimentos: `
             <h2 class="text-3xl font-bold text-gray-800 mb-2">Depoimentos da Comunidade</h2>
            <p class="text-gray-600 mb-8">Veja o que outros usu√°rios est√£o dizendo sobre a jornada com O C√≥digo do Sono.</p>
            <div id="testimonials-container" class="grid md:grid-cols-2 gap-6"></div>
        `
    };

    function navigateTo(section) {
        if (!sections[section]) return;
        appContent.innerHTML = sections[section];
        
        document.querySelectorAll('.sidebar-link').forEach(link => {
            link.classList.toggle('active', link.dataset.section === section);
        });

        // Re-initialize dynamic content
        if (section === 'plano-circadiano') initQuiz();
        if (section === 'plano-circadiano') initCircadianClock();
        if (section === 'local-respiracao') initBreathingTools();
        if (section === 'chas-para-dormir') initTeaRecipes();
        if (section === 'depoimentos') initTestimonials();

        // Close mobile menu on navigation
        closeMobileMenu();
    }
    
    // --- INITIALIZATION FUNCTIONS ---
    function initTestimonials() {
        const container = document.getElementById('testimonials-container');
        if (!container) return;
        container.innerHTML = '';
        appData.testimonials.forEach(testimonial => {
            const card = document.createElement('div');
            card.className = 'bg-white rounded-lg p-6 shadow-md flex flex-col';
            let stars = '';
            for (let i = 0; i < 5; i++) {
                stars += `<span class="${i < testimonial.rating ? 'text-yellow-400' : 'text-gray-300'}">‚òÖ</span>`;
            }
            card.innerHTML = `
                <div class="text-xl mb-2">${stars}</div>
                <blockquote class="text-gray-600 italic mb-4 flex-grow">‚Äú${testimonial.comment}‚Äù</blockquote>
                <cite class="font-semibold text-gray-800 self-end">‚Äî ${testimonial.name}</cite>
            `;
            container.appendChild(card);
        });
    }

    function initQuiz() {
        const quizContainer = document.getElementById('quiz-container-app');
        if (!quizContainer) return;
        quizContainer.innerHTML = '';
        
        appData.quiz.forEach((q, index) => {
            const questionBlock = document.createElement('div');
            questionBlock.className = 'mb-6';
            let optionsHTML = q.options.map((opt, optIndex) => `
                <label class="flex items-center bg-[#FDFBF8] border border-gray-200 rounded-lg p-4 mb-2 hover:bg-[#EAE3DC] cursor-pointer transition-colors">
                    <input type="radio" name="question-${index}" value="${optIndex}" class="mr-3 h-4 w-4 text-[#8C7A6B] focus:ring-[#8C7A6B] border-gray-300">
                    <span>${opt}</span>
                </label>
            `).join('');
            questionBlock.innerHTML = `<p class="font-semibold text-lg mb-3">${index + 1}. ${q.question}</p><div>${optionsHTML}</div>`;
            quizContainer.appendChild(questionBlock);
        });

        const submitBtn = document.getElementById('submit-quiz-app');
        quizContainer.addEventListener('change', () => {
            const answeredCount = appData.quiz.filter((_, index) => document.querySelector(`input[name="question-${index}"]:checked`)).length;
            submitBtn.disabled = answeredCount !== appData.quiz.length;
        });
        
        submitBtn.addEventListener('click', () => {
            document.getElementById('plan-app').innerHTML = `<p class="text-center text-green-700 bg-green-100 p-4 rounded-lg">Baseado em suas respostas, seu plano personalizado est√° sendo gerado. Foque nos m√≥dulos de **Rotina** e **Ambiente** na Biblioteca.</p>`;
            document.getElementById('plan-app').classList.remove('hidden');
        });
    }

    function initCircadianClock() {
        const clock = document.getElementById('circadian-clock');
        const detailsPanel = document.getElementById('circadian-details');
        if (!clock) return;

        clock.addEventListener('click', (e) => {
            const segment = e.target.closest('.circadian-segment');
            if (segment) {
                document.querySelectorAll('.circadian-segment').forEach(s => s.classList.remove('active'));
                segment.classList.add('active');
                const index = parseInt(segment.dataset.index);
                const data = appData.circadianPlan[index];
                detailsPanel.innerHTML = `
                    <div class="text-3xl mb-3">${data.icon}</div>
                    <h3 class="font-bold text-xl mb-2 text-[#4A5568]">${data.time} - ${data.title}</h3>
                    <p class="text-gray-600">${data.description}</p>
                `;
            }
        });
    }
    
    function initBreathingTools() {
        const container = document.getElementById('breathing-tools-container');
        if (!container) return;
        container.innerHTML = '';

        appData.breathingTools.forEach(tool => {
            const toolEl = document.createElement('div');
            toolEl.className = 'bg-white rounded-lg p-8 shadow-lg';
            toolEl.innerHTML = `
                <h3 class="font-bold text-xl mb-2 text-[#4A5568]">${tool.title}</h3>
                <div class="text-sm space-y-1 mb-4">
                    <p><strong class="text-gray-800">Para que serve:</strong> <span class="text-gray-600">${tool.purpose}</span></p>
                    <p><strong class="text-gray-800">Quando usar:</strong> <span class="text-gray-600">${tool.when}</span></p>
                </div>
                <div class="relative w-48 h-48 mx-auto flex items-center justify-center cursor-pointer breathing-guide" data-tool-id="${tool.id}">
                    <div class="absolute w-full h-full bg-[#EAE3DC] rounded-full"></div>
                    <div id="breathing-dot-${tool.id}" class="absolute w-8 h-8 bg-[#8C7A6B] rounded-full breathing-dot"></div>
                    <span id="breathing-text-${tool.id}" class="text-lg font-semibold text-[#4A5568]">Clique</span>
                </div>
                <p class="text-sm text-center text-gray-500 mt-2 italic">'Clique no centro para acalmar'</p>
            `;
            container.appendChild(toolEl);
        });
        
        document.querySelectorAll('.breathing-guide').forEach(guide => {
            guide.addEventListener('click', handleBreathingAnimation);
        });
    }

    function initTeaRecipes() {
        const container = document.getElementById('tea-recipes-container');
        if(!container) return;
        container.innerHTML = '';
        appData.teaRecipes.forEach(tea => {
            const card = document.createElement('div');
            card.className = 'bg-white rounded-lg p-6 shadow-md flex flex-col items-start';
            card.innerHTML = `
                <div class="text-3xl mb-3">${tea.emoji}</div>
                <h3 class="font-bold text-xl mb-1 text-[#4A5568]">${tea.title}</h3>
                <p class="text-gray-600 text-sm mb-4 flex-grow">${tea.benefit}</p>
                <button class="w-full bg-[#EAE3DC] text-[#4A5568] px-4 py-2 rounded-full font-semibold hover:bg-[#dcd1c6] transition-colors" data-tea-id="${tea.id}">Ver Receita</button>
            `;
            container.appendChild(card);
            card.querySelector('button').addEventListener('click', () => openTeaModal(tea));
        });
    }

    function openTeaModal(tea) {
        const modalContent = `
            <h2 class="text-2xl font-bold text-[#4A5568] mb-4">${tea.emoji} ${tea.title}</h2>
            <div class="space-y-4">
                <div>
                    <h4 class="font-semibold text-lg">Modo de Preparo</h4>
                    <p class="text-gray-600">${tea.recipe}</p>
                </div>
                <div class="bg-red-50 border border-red-200 text-red-800 p-4 rounded-lg">
                    <h4 class="font-semibold text-lg">Aten√ß√£o</h4>
                    <p class="text-sm">${tea.warning}</p>
                </div>
            </div>
        `;
        openGenericModal(modalContent);
    }
    
    // --- GENERIC MODAL ---
    const genericModalContainer = document.getElementById('generic-modal-container');
    const genericModalContent = document.getElementById('generic-modal-content');
    const genericModalClose = document.getElementById('generic-modal-close');
    
    function openGenericModal(content) {
        genericModalContent.innerHTML = content;
        genericModalContainer.classList.remove('hidden');
        genericModalContainer.classList.add('flex');
    }

    function closeGenericModal() {
        genericModalContainer.classList.add('hidden');
        genericModalContainer.classList.remove('flex');
    }

    genericModalClose.addEventListener('click', closeGenericModal);
    genericModalContainer.querySelector('.modal-backdrop').addEventListener('click', closeGenericModal);


    function handleBreathingAnimation(event) {
        const guide = event.currentTarget;
        const toolId = guide.dataset.toolId;

        if (currentAnimation.toolId === toolId) {
            stopBreathingAnimation();
        } else {
            stopBreathingAnimation();
            startBreathingAnimation(toolId);
        }
    }

    function startBreathingAnimation(toolId) {
        currentAnimation.toolId = toolId;
        const tool = appData.breathingTools.find(t => t.id === toolId);
        if (!tool) return;

        let stepIndex = 0;

        function runStep() {
            const step = tool.steps[stepIndex];
            const dot = document.getElementById(`breathing-dot-${toolId}`);
            const text = document.getElementById(`breathing-text-${toolId}`);
            
            if (dot && text) {
                dot.style.setProperty('--transition-duration', `${step.duration - 0.2}s`);
                dot.style.transform = `scale(${step.scale})`;
                text.textContent = step.label;
            }
            
            stepIndex = (stepIndex + 1) % tool.steps.length;
            currentAnimation.timeoutId = setTimeout(runStep, step.duration * 1000);
        }
        runStep();
    }

    function stopBreathingAnimation() {
        if (currentAnimation.timeoutId) {
            clearTimeout(currentAnimation.timeoutId);
        }
        if (currentAnimation.toolId) {
            const dot = document.getElementById(`breathing-dot-${currentAnimation.toolId}`);
            const text = document.getElementById(`breathing-text-${currentAnimation.toolId}`);
            if (dot && text) {
                dot.style.transform = 'scale(1)';
                text.textContent = 'Clique';
            }
        }
        currentAnimation.toolId = null;
        currentAnimation.timeoutId = null;
    }
    
    // --- NAVIGATION AND ROUTING ---
    const sidebarNav = document.getElementById('sidebar-nav');
    const mobileSidebarNav = document.getElementById('mobile-sidebar-nav');
    mobileSidebarNav.innerHTML = sidebarNav.innerHTML; // Clone nav links

    document.body.addEventListener('click', (e) => {
        const navLink = e.target.closest('.sidebar-link');
        const cardLink = e.target.closest('[data-nav-link]');
        
        if (navLink) {
            e.preventDefault();
            const section = navLink.dataset.section;
            navigateTo(section);
        } else if (cardLink) {
            const section = cardLink.dataset.navLink;
            navigateTo(section);
        }
    });

    // --- MOBILE MENU ---
    const mobileMenuBtn = document.getElementById('mobile-menu-btn');
    const closeMobileMenuBtn = document.getElementById('close-mobile-menu');
    const mobileSidebar = document.getElementById('mobile-sidebar');
    const mobileSidebarOverlay = document.getElementById('mobile-sidebar-overlay');
    
    function openMobileMenu() {
        mobileSidebar.classList.remove('-translate-x-full');
        mobileSidebarOverlay.classList.remove('hidden');
    }

    function closeMobileMenu() {
        mobileSidebar.classList.add('-translate-x-full');
        mobileSidebarOverlay.classList.add('hidden');
    }

    mobileMenuBtn.addEventListener('click', openMobileMenu);
    closeMobileMenuBtn.addEventListener('click', closeMobileMenu);
    mobileSidebarOverlay.addEventListener('click', closeMobileMenu);
    
    // --- PERSONALIZATION ---
    const welcomeMessageEl = document.getElementById('welcome-message');
    const welcomeModal = document.getElementById('welcome-modal-container');
    const welcomeForm = document.getElementById('welcome-form');
    const nameInput = document.getElementById('name-input');

    function updateWelcomeMessage(name) {
        if (welcomeMessageEl) {
            welcomeMessageEl.textContent = `Bem-vindo(a), ${name}!`;
        }
    }

    function initWelcome() {
        const savedName = localStorage.getItem('userName');
        if (savedName) {
            updateWelcomeMessage(savedName);
        } else {
            welcomeModal.classList.remove('hidden');
            welcomeModal.classList.add('flex');
        }

        welcomeForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const userName = nameInput.value.trim();
            if (userName) {
                localStorage.setItem('userName', userName);
                updateWelcomeMessage(userName);
                welcomeModal.classList.add('hidden');
                welcomeModal.classList.remove('flex');
            }
        });
    }

    // Initial load
    navigateTo('painel');
    initWelcome();
});
</script>
</body>
</html>

